{
  "name": "Exposure Assessment Agent",
  "nodes": [
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.4,
      "position": [
        -464,
        32
      ],
      "id": "37812227-6e21-402e-9e2a-1903e845d0b8",
      "name": "When chat message received",
      "webhookId": "388970bf-15ce-48fd-80d9-982f1bd2fc0b"
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "=You are a vulnerability exposure analyst. Your task is to assess the real-world risk of vulnerabilities by combining CVE intelligence with internet exposure data.\n\nWhen asked about a vulnerability or technology:\n1. Use the Qdrant tool to retrieve stored intelligence about the CVE, including affected products and versions\n2. Extract the product name and vulnerable version from the intelligence\n3. Use the Shodan tool to query how many systems running that product/version are exposed\n4. Combine both data sources to assess practical risk\n\nFor Shodan queries, use these patterns:\n- For product search: product:productname\n- For version-specific: product:productname version:X.X\n- For port-based: port:443 product:nginx\n- For organization: org:\"Company Name\"\n\nImportant: Do not use vuln: filter. Instead, search for the affected product and version directly.\n\nProvide your assessment in this format:\n- Vulnerability Summary: Brief description from stored intelligence\n- Affected Product: Product name and vulnerable versions\n- Exposure Level: Number of exposed systems found\n- Geographic Distribution: Top countries affected\n- Risk Assessment: Critical/High/Medium/Low based on CVSS + exposure\n- Recommendation: Specific action for the security team\n\nBe concise and actionable."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        -80,
        32
      ],
      "id": "e5453005-fce0-4d6c-afb1-6f56b1a88580",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -240,
        256
      ],
      "id": "5067f2a1-eff9-4f52-8a6b-b9bfa1fa3422",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "5VDd362hpABYIrAx",
          "name": "OpenAi account 2"
        }
      }
    },
    {
      "parameters": {
        "contextWindowLength": 2000
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        -112,
        256
      ],
      "id": "7bda072f-8195-4c9c-b8d9-c57f2b1d41ae",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "Qdrant Vector Store",
        "qdrantCollection": {
          "__rl": true,
          "value": "security_intel_raw",
          "mode": "list",
          "cachedResultName": "security_intel_raw"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreQdrant",
      "typeVersion": 1.3,
      "position": [
        16,
        256
      ],
      "id": "6c466209-d3df-4a1d-8f39-4c0a6a4aa0ef",
      "name": "Qdrant Vector Store",
      "credentials": {
        "qdrantApi": {
          "id": "OvOsfpGu3jNvJPnQ",
          "name": "QdrantApi account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        96,
        464
      ],
      "id": "45b97d4c-0edb-44f1-aaf8-c071867cfd6d",
      "name": "Embeddings OpenAI",
      "credentials": {
        "openAiApi": {
          "id": "5VDd362hpABYIrAx",
          "name": "OpenAi account 2"
        }
      }
    },
    {
      "parameters": {
        "description": "Search Shodan for internet-exposed devices and services. Use this to find how many systems are running a specific product or version. Query examples: \"product:apache\", \"product:apache version:2.4.49\", \"product:nginx version:1.18\", \"port:22\"",
        "workflowId": {
          "__rl": true,
          "value": "yHhypKYCAiuDQmjf",
          "mode": "list",
          "cachedResultUrl": "/workflow/yHhypKYCAiuDQmjf",
          "cachedResultName": "Shodan Search Tool"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        304,
        256
      ],
      "id": "01b9e631-486f-4335-bc8e-be12dc3d4d25",
      "name": "Shodan Search Tool"
    }
  ],
  "pinData": {},
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Qdrant Vector Store": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI": {
      "ai_embedding": [
        [
          {
            "node": "Qdrant Vector Store",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Shodan Search Tool": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "873fc792-deb1-4784-80dc-709f2599c2ff",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "33a6384be4595f666734840b1a2564f4ca97d56c3047e8f1501a8302d137aba7"
  },
  "id": "T2kH6R62bHA5aIGu",
  "tags": []
}