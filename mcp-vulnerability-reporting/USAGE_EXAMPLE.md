# Usage Example - AI-Generated Report Content

This MCP requires the AI (Claude) to generate all report content based on the specific vulnerability instance. The template structure is maintained, but the content is dynamically created.

## Example: SQL Injection Report

### User Request
```
"Test https://vulnerable-site.com/login for SQL injection and create a professional report"
```

### Step 1: Browser MCP - Vulnerability Testing
```javascript
browser_navigate({
  url: "https://vulnerable-site.com/login"
})

browser_test_payload({
  targetSelector: "#username",
  payload: "' OR 1=1--",
  submitSelector: "#login"
})
// Result: { isVulnerable: true, confidence: "high", detectedBehaviors: ["SQL_ERROR_MESSAGE", "AUTHENTICATION_BYPASS"] }

browser_screenshot({
  path: "./evidence/sqli-bypass.png"
})
```

### Step 2: Reporting MCP - AI Generates Report Content

**Claude Desktop automatically calls:**

```javascript
create_vulnerability_report({
  vulnerability: {
    type: "SQL_INJECTION",
    severity: "Critical",
    url: "https://vulnerable-site.com/login",
    parameter: "username",
    payload: "' OR 1=1--",
    method: "POST"
  },

  // AI GENERATES THIS BASED ON THE VULNERABILITY TYPE:
  overview: `SQL Injection is a code injection technique that exploits security vulnerabilities in an application's database layer. This vulnerability occurs when user-supplied input is incorporated into SQL queries without proper sanitization or parameterization. An attacker can manipulate SQL queries by injecting malicious SQL code through input fields, URL parameters, or HTTP headers. This can lead to unauthorized access to sensitive data, modification or deletion of database records, and in some cases, complete system compromise. SQL injection remains one of the most critical web application vulnerabilities and is consistently ranked in the OWASP Top 10.`,

  findings: {
    // AI GENERATES THIS BASED ON THE SPECIFIC INSTANCE:
    specificDescription: `The login form at /login endpoint is vulnerable to SQL injection via the username parameter. The application directly concatenates user input into SQL queries without using parameterized statements or proper input validation. By injecting a SQL comment sequence (--) combined with a boolean condition (OR 1=1), an attacker can completely bypass the authentication mechanism. Testing revealed that the payload ' OR 1=1-- successfully authenticates as the first user in the database (typically an administrator account). The vulnerability affects the POST /login endpoint and allows unauthorized access to the entire application.`,

    detectedBehaviors: [
      "SQL_ERROR_MESSAGE",
      "AUTHENTICATION_BYPASS",
      "STATUS_CODE_CHANGE"
    ],
    confidence: "high"
  },

  // AI GENERATES THESE STEPS BASED ON THE TESTING:
  stepsToReproduce: [
    "Navigate to https://vulnerable-site.com/login",
    "In the username field, enter the payload: ' OR 1=1--",
    "In the password field, enter any value (e.g., 'test')",
    "Click the 'Login' button or submit the form",
    "Observe successful authentication bypass - the application logs you in as the first user in the database",
    "Verify by checking the session cookie and accessing restricted admin pages"
  ],

  // AI GENERATES REMEDIATION STEPS:
  recommendations: [
    "- **Use Parameterized Queries**: Implement prepared statements with parameterized queries for all database interactions. This ensures that user input is treated as data, not executable code. Replace dynamic SQL concatenation with bound parameters in all authentication and data retrieval queries.",

    "- **Input Validation and Sanitization**: Implement strict server-side input validation on all user-supplied data. Use allowlists to define acceptable input patterns for usernames and other fields. Reject any input containing SQL metacharacters such as quotes, semicolons, or comment markers.",

    "- **Principle of Least Privilege**: Configure database accounts used by the application with minimal necessary permissions. The application should not connect to the database using administrative or root accounts. Create dedicated service accounts with restricted access to only required tables and operations.",

    "- **Web Application Firewall (WAF)**: Deploy a Web Application Firewall with rules specifically designed to detect and block SQL injection attempts. Configure the WAF to inspect POST body parameters and implement rate limiting to prevent automated exploitation.",

    "- **Security Testing Integration**: Incorporate automated security testing into the CI/CD pipeline. Conduct regular penetration testing and security code reviews to identify SQL injection vulnerabilities before they reach production environments."
  ],

  // AI GENERATES IMPACT ANALYSIS:
  impacts: [
    "- **Complete Authentication Bypass**: An attacker can bypass the login mechanism entirely and gain unauthorized access to any user account in the system, including administrative accounts. This provides immediate access to all application functionality and sensitive data without requiring valid credentials.",

    "- **Sensitive Data Exfiltration**: Using advanced SQL injection techniques such as UNION-based attacks, an attacker can extract the entire contents of the database, including user credentials, personal information, financial records, and proprietary business data. This could lead to identity theft, financial fraud, and regulatory compliance violations.",

    "- **Database Manipulation and Integrity Loss**: The attacker could modify or delete database records, leading to data corruption, loss of critical business information, and disruption of operations. This includes the ability to create new admin accounts, modify user permissions, or destroy audit logs to cover their tracks.",

    "- **Full System Compromise**: In scenarios where database functionality permits, attackers may execute operating system commands through SQL injection (e.g., using xp_cmdshell in SQL Server or sys_exec in MySQL). This could lead to complete server takeover, installation of backdoors, lateral movement within the network, and persistent access to the infrastructure."
  ],

  // AI CAN OPTIONALLY PROVIDE CUSTOM REFERENCES (if not provided, template defaults are used):
  references: [
    { title: "OWASP: SQL Injection", url: "https://owasp.org/www-community/attacks/SQL_Injection" },
    { title: "CWE-89: Improper Neutralization of Special Elements used in an SQL Command", url: "https://cwe.mitre.org/data/definitions/89.html" },
    { title: "OWASP SQL Injection Prevention Cheat Sheet", url: "https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html" },
    { title: "PortSwigger: SQL Injection", url: "https://portswigger.net/web-security/sql-injection" }
  ]
})
```

### Step 3: Add Evidence

```javascript
add_evidence_to_report({
  reportId: "vuln_report_xxx",
  evidenceType: "screenshot",
  content: "./evidence/sqli-bypass.png",
  description: "Authentication Bypass - Successfully logged in as admin using SQL injection"
})
```

### Step 4: Export Report

```javascript
export_report({
  reportId: "vuln_report_xxx",
  outputPath: "./reports/sql-injection-login-bypass.md"
})
```

## Generated Report Output

The above will generate a markdown file following the template structure:

```markdown
## Vulnerability Overview

[AI-generated overview content here]

### Finding Details

[AI-generated specific findings here]

### Steps To Reproduce

1. [AI-generated step 1]
2. [AI-generated step 2]
3. [etc...]

## Recommendations

To address this finding, implement the following:

- **Use Parameterized Queries**: [AI-generated recommendation details]
- **Input Validation**: [AI-generated recommendation details]
[etc...]

## References

See the following for more information:

- [AI-generated or template default references]

## Impacts

If not addressed, this finding could lead to the following:

- **Complete Authentication Bypass**: [AI-generated impact details]
- **Data Breach**: [AI-generated impact details]
[etc...]
```

## Key Points

1. **Template Structure is Preserved**: The markdown format exactly matches `/Users/orhanyildirim/Desktop/mcp-browser-injection-extented/report.md`

2. **Content is AI-Generated**: Claude generates all content based on:
   - The specific vulnerability found
   - The testing results from browser_test_payload
   - Knowledge of security best practices
   - Context from the target application

3. **Flexibility**: AI can customize content for:
   - Different vulnerability types
   - Different severity levels
   - Specific application contexts
   - Client requirements (bug bounty vs. pentest report)

4. **No Hard-coded Templates**: Unlike the previous version, this doesn't use pre-written templates from `vulnerability-db.ts`. The AI creates fresh, contextual content for each report.

5. **References Can Be Custom or Default**: If AI doesn't provide references, the system falls back to template defaults from the vulnerability database.
